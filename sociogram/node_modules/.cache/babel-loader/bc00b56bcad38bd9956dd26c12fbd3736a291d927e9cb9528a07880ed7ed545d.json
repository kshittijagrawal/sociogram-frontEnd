{"ast":null,"code":"module.exports = function parseUrlAsView(req, v, error) {\n  var _url = req.url;\n  // TODO: expose in view module as common method\n  // Note: parseUrlAsView method is copy and pasted from internals of `view` module\n  // todo: keep track of level found, if we 404'd in a found level, show last known parent\n  var parts = require('url').parse(_url).pathname.replace('options.prefix', '').split('/');\n  parts.shift();\n  //console.log(parts)\n\n  // Remark: special case for root with no index, should be refactored\n  //console.log(\"FML\", v.key)\n  if (parts.length === 1 && parts[0] === '' && !v['index']) {\n    /*\n    if (error !== false) {\n      return missingViewHandler();\n    }\n    */\n    //console.log('return missing / default view')\n    return v;\n  }\n  var previousView;\n  var foundViews = 0;\n  //console.log('VIEW', v)\n  parts.forEach(function (part, i) {\n    //console.log(part)\n    if (part.length > 0 && typeof v !== 'undefined') {\n      if (typeof v[part] !== \"undefined\") {\n        foundViews++;\n        v = v[part];\n        if (typeof v.presenter !== 'function' && typeof v['index'] !== \"undefined\" && i === parts.length - 1) {\n          v = v['index'];\n        }\n      } else if (v['index']) {\n        v = v['index'];\n        //foundViews++;\n      }\n    }\n  });\n\n  if (foundViews < parts.length) {\n    req.resource.params.id = parts[foundViews]; // TODO: switch back to array.slice to preserve additional route params\n  }\n\n  if (parts.length === 1) {\n    req.resource.params.id = parts[0];\n  }\n\n  //console.log('FOUND', v.key, req.resource.params)\n  return v;\n};","map":{"version":3,"names":["module","exports","parseUrlAsView","req","v","error","_url","url","parts","require","parse","pathname","replace","split","shift","length","previousView","foundViews","forEach","part","i","presenter","resource","params","id"],"sources":["/Users/ayanyadav/node_modules/view/lib/parseUrlAsView.js"],"sourcesContent":["module.exports = function parseUrlAsView (req, v, error) {\n  var _url = req.url;\n  // TODO: expose in view module as common method\n  // Note: parseUrlAsView method is copy and pasted from internals of `view` module\n  // todo: keep track of level found, if we 404'd in a found level, show last known parent\n  var parts = require('url').parse(_url).pathname.replace('options.prefix', '').split('/');\n  parts.shift();\n  //console.log(parts)\n  \n  // Remark: special case for root with no index, should be refactored\n  //console.log(\"FML\", v.key)\n  if (parts.length === 1 && parts[0] === '' && !v['index']) {\n    /*\n    if (error !== false) {\n      return missingViewHandler();\n    }\n    */\n    //console.log('return missing / default view')\n    return v;\n  }\n  var previousView;\n  var foundViews = 0;\n  //console.log('VIEW', v)\n  parts.forEach(function(part, i) {\n    //console.log(part)\n    if(part.length > 0 && typeof v !== 'undefined') {\n      if (typeof v[part] !== \"undefined\") {\n        foundViews++;\n        v = v[part];\n        if (typeof v.presenter !== 'function' && typeof v['index'] !== \"undefined\" && i === parts.length - 1) {\n          v = v['index'];\n        }\n      }\n      else if (v['index']) {\n        v = v['index'];\n        //foundViews++;\n      }\n    }\n  });\n\n  if (foundViews < parts.length) {\n    req.resource.params.id = parts[foundViews]; // TODO: switch back to array.slice to preserve additional route params\n  }\n\n  if (parts.length === 1) {\n    req.resource.params.id = parts[0];\n  }\n\n  //console.log('FOUND', v.key, req.resource.params)\n  return v;\n};"],"mappings":"AAAAA,MAAM,CAACC,OAAO,GAAG,SAASC,cAAc,CAAEC,GAAG,EAAEC,CAAC,EAAEC,KAAK,EAAE;EACvD,IAAIC,IAAI,GAAGH,GAAG,CAACI,GAAG;EAClB;EACA;EACA;EACA,IAAIC,KAAK,GAAGC,OAAO,CAAC,KAAK,CAAC,CAACC,KAAK,CAACJ,IAAI,CAAC,CAACK,QAAQ,CAACC,OAAO,CAAC,gBAAgB,EAAE,EAAE,CAAC,CAACC,KAAK,CAAC,GAAG,CAAC;EACxFL,KAAK,CAACM,KAAK,EAAE;EACb;;EAEA;EACA;EACA,IAAIN,KAAK,CAACO,MAAM,KAAK,CAAC,IAAIP,KAAK,CAAC,CAAC,CAAC,KAAK,EAAE,IAAI,CAACJ,CAAC,CAAC,OAAO,CAAC,EAAE;IACxD;AACJ;AACA;AACA;AACA;IACI;IACA,OAAOA,CAAC;EACV;EACA,IAAIY,YAAY;EAChB,IAAIC,UAAU,GAAG,CAAC;EAClB;EACAT,KAAK,CAACU,OAAO,CAAC,UAASC,IAAI,EAAEC,CAAC,EAAE;IAC9B;IACA,IAAGD,IAAI,CAACJ,MAAM,GAAG,CAAC,IAAI,OAAOX,CAAC,KAAK,WAAW,EAAE;MAC9C,IAAI,OAAOA,CAAC,CAACe,IAAI,CAAC,KAAK,WAAW,EAAE;QAClCF,UAAU,EAAE;QACZb,CAAC,GAAGA,CAAC,CAACe,IAAI,CAAC;QACX,IAAI,OAAOf,CAAC,CAACiB,SAAS,KAAK,UAAU,IAAI,OAAOjB,CAAC,CAAC,OAAO,CAAC,KAAK,WAAW,IAAIgB,CAAC,KAAKZ,KAAK,CAACO,MAAM,GAAG,CAAC,EAAE;UACpGX,CAAC,GAAGA,CAAC,CAAC,OAAO,CAAC;QAChB;MACF,CAAC,MACI,IAAIA,CAAC,CAAC,OAAO,CAAC,EAAE;QACnBA,CAAC,GAAGA,CAAC,CAAC,OAAO,CAAC;QACd;MACF;IACF;EACF,CAAC,CAAC;;EAEF,IAAIa,UAAU,GAAGT,KAAK,CAACO,MAAM,EAAE;IAC7BZ,GAAG,CAACmB,QAAQ,CAACC,MAAM,CAACC,EAAE,GAAGhB,KAAK,CAACS,UAAU,CAAC,CAAC,CAAC;EAC9C;;EAEA,IAAIT,KAAK,CAACO,MAAM,KAAK,CAAC,EAAE;IACtBZ,GAAG,CAACmB,QAAQ,CAACC,MAAM,CAACC,EAAE,GAAGhB,KAAK,CAAC,CAAC,CAAC;EACnC;;EAEA;EACA,OAAOJ,CAAC;AACV,CAAC"},"metadata":{},"sourceType":"script","externalDependencies":[]}